
## üß© SSTI (Server-Side Template Injection)

---

## Introduction

La <span class="concept">SSTI</span> permet √† un attaquant d‚Äôinjecter des payloads dans un moteur de template utilis√© c√¥t√© serveur.

Elle peut permettre :
- Ex√©cution de code arbitraire (RCE)
- Lecture de fichiers sensibles
- Mouvement lat√©ral vers le serveur

Typique sur :
- Flask (Jinja2)
- Django
- Thymeleaf (Java)
- Freemarker (Java)
- Smarty (PHP)
- Twig (PHP)

---

## Objectifs

- <span class="goal">Identifier un vecteur SSTI</span>
- <span class="goal">Ex√©cuter des payloads contr√¥l√©s</span>
- <span class="goal">Obtenir un RCE ou un shell</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">Burp Suite (Repeater)</span> | Injection manuelle |
| <span class="technology">tplmap</span> | <span class="example">tplmap -u target --os-shell</span> |
| <span class="technology">PayloadsAllTheThings</span> | Cheatsheet SSTI |
| <span class="technology">ffuf</span> | Fuzz de param√®tres |
| <span class="technology">Param Miner</span> | D√©couverte de param vuln√©rables |
| <span class="technology">bbot</span> | Recon |

---

## Types de SSTI

| Type | Exemple |
|------|---------|
| <span class="concept">Basic SSTI</span> | `{{7*7}}` |
| <span class="concept">Contextual SSTI</span> | Injection d√©pendante du moteur |
| <span class="concept">Blind SSTI</span> | Injection d√©tect√©e via timing / exfil |
| <span class="concept">Chained SSTI ‚Üí RCE</span> | Utilisation d‚Äôobjets pour atteindre un RCE |
| <span class="concept">SSTI + XSS</span> | Injection crois√©e |

---

## Techniques cl√©s

| Technique | Outil |
|-----------|------|
| <span class="concept">Manual payload</span> | Burp |
| <span class="concept">Automated testing</span> | tplmap |
| <span class="concept">Param discovery</span> | Param Miner |
| <span class="concept">Bypass filters</span> | manual |
| <span class="concept">Blind SSTI</span> | timing / DNS callback |

---

## Payloads courants

```
{{7*7}}
${7*7}
<%= 7*7 %>
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
```

---

## Bonnes pratiques

- <span class="best-practice">Identifier le moteur de template</span> (Flask ? Twig ?...)</span>
- <span class="best-practice">V√©rifier le contexte (GET, POST, Headers, JSON...)</span>
- <span class="best-practice">Limiter les tests en prod (blind SSTI ‚Üí moins risqu√©)</span>
- <span class="best-practice">Documenter impact (RCE ? read ? XSS ?)</span>

---

## üéØ Exemple de sc√©nario

> <span class="note">üß© Cible :</span> Web app Python Flask

Actions :
- <span class="technology">Param Miner</span> ‚Üí d√©couverte param vuln√©rable `name`
- <span class="technology">Burp Repeater</span> ‚Üí injection `{{7*7}}` ‚Üí 49 confirm√©
- Test avanc√© ‚Üí `{{ cycler.__init__.__globals__.os.popen('id').read() }}` ‚Üí RCE valid√©
- <span class="technology">tplmap --os-shell</span> ‚Üí shell interactif obtenu
- Rapport complet

---

## Cheatlist SSTI

| Type | Outils |
|------|--------|
| Manual | Burp, PayloadsAllTheThings |
| Automated | tplmap |
| Param discovery | Param Miner |
| Blind | Manual |

---

## üöÄ Navigation

- üöÄ [[02_Pentest_Web/01_OWASP_Top10]]
