
## 🐞 SQL Injection (SQLi)

---

## Introduction

La <span class="concept">SQL Injection (SQLi)</span> est l’une des failles Web les plus connues — et toujours critique lorsqu’exploitée.

Elle permet à un attaquant de manipuler des requêtes SQL pour :
- Exfiltrer des données
- Bypass l’authentification
- Prendre le contrôle de l’application
- Potentiellement exécuter du code sur le serveur

Le pentester doit savoir :
- Détecter les différents types de SQLi
- Construire des payloads adaptés
- Qualifier l’impact réel

---

## Objectifs

- <span class="goal">Identifier des points d’injection SQL</span>
- <span class="goal">Qualifier le type de SQLi</span>
- <span class="goal">Obtenir des données sensibles ou contrôle</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">Burp Suite (Repeater)</span> | Injection manuelle et fuzzing |
| <span class="technology">sqlmap</span> | <span class="example">sqlmap -u target --dbs</span> |
| <span class="technology">sqlninja</span> | Ciblé SQL Server |
| <span class="technology">NoSQLMap</span> | Injection MongoDB, NoSQL |
| <span class="technology">BBOT</span> | Recon + endpoints potentiellement vulnérables |
| <span class="technology">Wafw00f</span> | Détection de WAF |
| <span class="technology">Arjun</span> | Paramètre discovery |

---

## Types de SQLi

| Type | Exemple |
|------|---------|
| <span class="concept">Error-Based SQLi</span> | Requête provoquant un message d’erreur SQL |
| <span class="concept">Union-Based SQLi</span> | Utilisation de UNION pour lire d’autres tables |
| <span class="concept">Boolean-Based Blind</span> | Réponse modifiée selon vrai / faux |
| <span class="concept">Time-Based Blind</span> | Utilisation de DELAY pour détecter injection |
| <span class="concept">Out-Of-Band (OOB)</span> | Exploitation via DNS / HTTP hors bande |
| <span class="concept">NoSQL Injection</span> | Exploitation base MongoDB / NoSQL |

---

## Techniques clés

| Technique | Outil |
|-----------|------|
| <span class="concept">Injection manuelle</span> | Burp Repeater |
| <span class="concept">Automated discovery</span> | sqlmap |
| <span class="concept">Fuzz param discovery</span> | Arjun |
| <span class="concept">Bypass WAF</span> | Burp, sqlmap tamper scripts |
| <span class="concept">Blind SQLi exploitation</span> | sqlmap |
| <span class="concept">NoSQL fuzzing</span> | NoSQLMap |

---

## Bonnes pratiques

- <span class="best-practice">Toujours identifier le SGBD (MySQL, MSSQL, Oracle...)</span>
- <span class="best-practice">Préférer la validation manuelle avant automatisation</span>
- <span class="best-practice">Limiter le bruit sur les cibles prod</span>
- <span class="best-practice">Documenter l’impact réel (data extract / bypass)</span>
- <span class="mitigation">Éviter les full tests sur login (risque de lockout)</span>

---

## 🎯 Exemple de scénario

> <span class="note">🐞 Cible :</span> Web app CRM vulnérable

Actions :
- <span class="technology">Arjun</span> → découverte param `id_client`
- <span class="technology">Burp Repeater</span> → injection simple `' OR 1=1--`
- <span class="technology">sqlmap -u target?id_client=1 --dbs</span> → Union-Based SQLi validé
- Extraction complète de la DB client
- Tentative de blind time-based → DELAY fonctionne
- Rapport complet avec captures et payloads

---

## Cheatlist SQLi

| Type | Outils |
|------|--------|
| Error-Based | Burp, sqlmap |
| Union | sqlmap, manual |
| Blind (boolean / time) | sqlmap |
| Out-of-band | sqlmap + DNS exploit |
| NoSQL | NoSQLMap, Burp |

---

## 🚀 Navigation

- 🚀 [[05_SSRF]]
- 🚀 [[06_IDOR]]
