
## 🗂️ IDOR (Insecure Direct Object Reference)

---

## Introduction

L’<span class="concept">IDOR</span> (Insecure Direct Object Reference) permet à un attaquant d’accéder à des ressources non autorisées en manipulant un identifiant.

Souvent critique :
- Accès à des comptes tiers
- Lecture ou modification de données sensibles
- Escalade d’autorisations

Exemples :
- `/profile?id=1000` → voir le profil d’un autre utilisateur
- `/invoice/2024-001.pdf` → télécharger les factures des autres

---

## Objectifs

- <span class="goal">Identifier des IDOR</span>
- <span class="goal">Qualifier l’impact (lecture, écriture, suppression...)</span>
- <span class="goal">Documenter la faille pour remédiation</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">Burp Suite (Proxy + Repeater)</span> | Test manuel |
| <span class="technology">Autorize</span> | Automatiser la détection |
| <span class="technology">Param Miner</span> | Découverte de paramètres |
| <span class="technology">ffuf</span> | Fuzz d’identifiants |
| <span class="technology">feroxbuster</span> | Discovery large |
| <span class="technology">bbot</span> | Recon |
| <span class="technology">jwt.io / JWT Inspector</span> | IDOR via JWT manipulé |

---

## Types d’IDOR

| Type | Exemple |
|------|---------|
| <span class="concept">GET param</span> | `/user?id=42` |
| <span class="concept">POST param</span> | `{ "invoice_id": "23" }` |
| <span class="concept">API REST ID</span> | `/api/v1/users/23` |
| <span class="concept">Hidden param</span> | champ hidden form |
| <span class="concept">JWT IDOR</span> | token manipulé |

---

## Techniques clés

| Technique | Outil |
|-----------|------|
| <span class="concept">Manual ID manipulation</span> | Burp Repeater |
| <span class="concept">Automated testing</span> | Autorize |
| <span class="concept">Param discovery</span> | Param Miner |
| <span class="concept">Fuzz ID range</span> | ffuf |
| <span class="concept">JWT manipulation</span> | jwt.io |

---

## Bonnes pratiques

- <span class="best-practice">Tester à plusieurs niveaux (GET, POST, API, JWT)</span>
- <span class="best-practice">Toujours changer de session user (pour voir cross-user)</span>
- <span class="best-practice">Documenter l’impact métier (lecture seule ? écriture ?)</span>
- <span class="mitigation">Limiter le bruit (ne pas flooder l’API en prod)</span>

---

## 🎯 Exemple de scénario

> <span class="note">🗂️ Cible :</span> Web app SaaS B2B

Actions :
- <span class="technology">Param Miner</span> → découverte param `client_id`
- <span class="technology">ffuf</span> → ID fuzzing `/invoice/NNN.pdf`
- Accès confirmé aux factures d’autres clients
- <span class="technology">Autorize</span> → API REST vulnérable `/api/v1/users/`
- Rapport complet avec POC et screenshots

---

## Cheatlist IDOR

| Type | Outils |
|------|--------|
| Manual | Burp, Repeater |
| Automated | Autorize |
| Param discovery | Param Miner |
| Fuzz | ffuf |
| JWT | jwt.io, JWT Inspector |

---

## 🚀 Navigation

- 🚀 [[09_SSRF]]
- 🚀 [[10_SSTI]]
