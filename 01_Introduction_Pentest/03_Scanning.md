## 📡 Scanning

---

## Introduction

Le <span class="concept">scanning</span> est une phase active permettant de découvrir les <span class="protocol">services exposés</span> sur les systèmes cibles.

Une approche progressive et méthodique permet de :
- Limiter la détection (IDS/IPS)
- Gagner du temps sur la phase d’exploitation
- Prioriser les vecteurs d’attaque pertinents

On distingue généralement :
- Les scans de ports
- La détection de versions et services
- La détection d’OS
- La recherche de vulnérabilités connues

---

## Objectifs

- <span class="goal">Cartographier les services réseau exposés</span>
- <span class="goal">Identifier les versions vulnérables</span>
- <span class="goal">Fournir une base pour l’exploitation ciblée</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">nmap</span> | <span class="example">nmap -sS -p- -T4 target.com</span> → <span class="note">Scan TCP SYN furtif (`-sS`), tous ports (`-p-`), rapide (`-T4`)</span> |
| <span class="technology">nmap</span> | <span class="example">nmap -sU -p 53,123,161 target.com</span> → <span class="note">Scan UDP pour ports DNS, NTP, SNMP</span> |
| <span class="technology">nmap</span> | <span class="example">nmap -sV -O target.com</span> → <span class="note">Détection de versions (`-sV`) + fingerprinting OS (`-O`)</span> |
| <span class="technology">nmap</span> | <span class="example">nmap --script vuln -p 80,443 target.com</span> → <span class="note">Recherche vulnérabilités connues (scripts NSE vuln)</span> |
| <span class="technology">masscan</span> | <span class="example">masscan -p1-65535 target.com --rate 1000</span> → <span class="note">Scan ultra rapide, à doser (risque DoS !)</span> |
| <span class="technology">rustscan</span> | <span class="example">rustscan -a target.com -- -sV</span> → <span class="note">Scan très rapide → pipe vers Nmap pour versionning</span> |
| <span class="technology">naabu</span> | <span class="example">naabu -host target.com -p -</span> → <span class="note">Scanner TCP optimisé, très léger</span> |

---

## Techniques actives

| Type de scan | Exemple |
|--------------|---------|
| <span class="concept">TCP SYN Scan</span> | <span class="example">nmap -sS</span> → rapide, discret |
| <span class="concept">TCP Connect Scan</span> | <span class="example">nmap -sT</span> → complet, plus visible |
| <span class="concept">UDP Scan (sélectif)</span> | <span class="example">nmap -sU -p 53,161</span> |
| <span class="concept">Full port scan</span> | <span class="example">nmap -p-</span> |
| <span class="concept">Version detection</span> | <span class="example">nmap -sV</span> |
| <span class="concept">OS fingerprinting</span> | <span class="example">nmap -O</span> |
| <span class="concept">Vuln NSE</span> | <span class="example">nmap --script vuln</span> |

---


---

## Mode safe vs agressif

- Mode <span class="goal">safe</span> : <span class="example">-sS</span>, <span class="example">-T3</span>, ports filtrés, pas de scripts NSE
- Mode <span class="goal">aggressif</span> : <span class="example">-sC -sV -O -p-</span>, <span class="example">--script vuln</span> → plus bruyant (risque de détection)
- <span class="mitigation">Adapter selon l’environnement cible : prod, recette, test, CTF</span>


## Bonnes pratiques

- <span class="best-practice">Commencer par un top 1000 ports (`--top-ports 1000`)</span>
- <span class="best-practice">Prioriser un scan furtif (`-sS` + `-T3`)</span> pour éviter détection sur IPS/EDR
- <span class="mitigation">Limiter le scan UDP pour éviter ralentissement (sélectionner ports pertinents)</span>
- <span class="best-practice">Documenter précisément les options utilisées dans chaque rapport</span>
- <span class="mitigation">Adapter le rythme (`--rate`) pour éviter l’impact réseau</span>
- <span class="best-practice">Utiliser <span class="technology">Rustscan</span> pour accélérer Nmap (Rustscan → Nmap)</span>

---

## 🎯 Exemple de scénario

> <span class="note">🎯 Cible :</span> VPN + serveur web sur `vpn.target.ch`

Actions :
- <span class="technology">nmap -p- -sS -T4 vpn.target.ch</span> → ports 443, 500, 4500
- <span class="technology">nmap -sV -O -p 443,500,4500 vpn.target.ch</span> → Gateway VPN IPsec + serveur HTTPS
- <span class="technology">nmap --script vuln -p 443 vpn.target.ch</span> → vérification vulnérabilités connues
- <span class="technology">masscan -p1-65535 vpn.target.ch --rate 500</span> → validation full ports
- <span class="technology">rustscan -a vpn.target.ch -- -sV</span> → confirmation version Gateway VPN

---

## 🚀 Navigation

- 🧩 [[04_Enumeration]]
- 🚀 [[05_Exploitation]]
