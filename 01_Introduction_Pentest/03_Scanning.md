## ğŸ“¡ Scanning

---

## Introduction

Le <span class="concept">scanning</span> est une phase active permettant de dÃ©couvrir les <span class="protocol">services exposÃ©s</span> sur les systÃ¨mes cibles.

Une approche progressive et mÃ©thodique permet de :
- Limiter la dÃ©tection (IDS/IPS)
- Gagner du temps sur la phase dâ€™exploitation
- Prioriser les vecteurs dâ€™attaque pertinents

On distingue gÃ©nÃ©ralement :
- Les scans de ports
- La dÃ©tection de versions et services
- La dÃ©tection dâ€™OS
- La recherche de vulnÃ©rabilitÃ©s connues

---

## Objectifs

- <span class="goal">Cartographier les services rÃ©seau exposÃ©s</span>
- <span class="goal">Identifier les versions vulnÃ©rables</span>
- <span class="goal">Fournir une base pour lâ€™exploitation ciblÃ©e</span>

---

## Outils & commandes

| Outil | Exemple & explication |
|-------|-----------------------|
| <span class="technology">nmap</span> | <span class="example">nmap -sS -p- -T4 target.com</span> â†’ <span class="note">Scan TCP SYN furtif (`-sS`), tous ports (`-p-`), rapide (`-T4`)</span> |
| <span class="technology">nmap</span> | <span class="example">nmap -sU -p 53,123,161 target.com</span> â†’ <span class="note">Scan UDP pour ports DNS, NTP, SNMP</span> |
| <span class="technology">nmap</span> | <span class="example">nmap -sV -O target.com</span> â†’ <span class="note">DÃ©tection de versions (`-sV`) + fingerprinting OS (`-O`)</span> |
| <span class="technology">nmap</span> | <span class="example">nmap --script vuln -p 80,443 target.com</span> â†’ <span class="note">Recherche vulnÃ©rabilitÃ©s connues (scripts NSE vuln)</span> |
| <span class="technology">masscan</span> | <span class="example">masscan -p1-65535 target.com --rate 1000</span> â†’ <span class="note">Scan ultra rapide, Ã  doser (risque DoS !)</span> |
| <span class="technology">rustscan</span> | <span class="example">rustscan -a target.com -- -sV</span> â†’ <span class="note">Scan trÃ¨s rapide â†’ pipe vers Nmap pour versionning</span> |
| <span class="technology">naabu</span> | <span class="example">naabu -host target.com -p -</span> â†’ <span class="note">Scanner TCP optimisÃ©, trÃ¨s lÃ©ger</span> |

---

## Techniques actives

| Type de scan | Exemple |
|--------------|---------|
| <span class="concept">TCP SYN Scan</span> | <span class="example">nmap -sS</span> â†’ rapide, discret |
| <span class="concept">TCP Connect Scan</span> | <span class="example">nmap -sT</span> â†’ complet, plus visible |
| <span class="concept">UDP Scan (sÃ©lectif)</span> | <span class="example">nmap -sU -p 53,161</span> |
| <span class="concept">Full port scan</span> | <span class="example">nmap -p-</span> |
| <span class="concept">Version detection</span> | <span class="example">nmap -sV</span> |
| <span class="concept">OS fingerprinting</span> | <span class="example">nmap -O</span> |
| <span class="concept">Vuln NSE</span> | <span class="example">nmap --script vuln</span> |

---


---

## Mode safe vs agressif

- Mode <span class="goal">safe</span> : <span class="example">-sS</span>, <span class="example">-T3</span>, ports filtrÃ©s, pas de scripts NSE
- Mode <span class="goal">aggressif</span> : <span class="example">-sC -sV -O -p-</span>, <span class="example">--script vuln</span> â†’ plus bruyant (risque de dÃ©tection)
- <span class="mitigation">Adapter selon lâ€™environnement cible : prod, recette, test, CTF</span>


## Bonnes pratiques

- <span class="best-practice">Commencer par un top 1000 ports (`--top-ports 1000`)</span>
- <span class="best-practice">Prioriser un scan furtif (`-sS` + `-T3`)</span> pour Ã©viter dÃ©tection sur IPS/EDR
- <span class="mitigation">Limiter le scan UDP pour Ã©viter ralentissement (sÃ©lectionner ports pertinents)</span>
- <span class="best-practice">Documenter prÃ©cisÃ©ment les options utilisÃ©es dans chaque rapport</span>
- <span class="mitigation">Adapter le rythme (`--rate`) pour Ã©viter lâ€™impact rÃ©seau</span>
- <span class="best-practice">Utiliser <span class="technology">Rustscan</span> pour accÃ©lÃ©rer Nmap (Rustscan â†’ Nmap)</span>

---

## ğŸ¯ Exemple de scÃ©nario

> <span class="note">ğŸ¯ Cible :</span> VPN + serveur web sur `vpn.target.ch`

Actions :
- <span class="technology">nmap -p- -sS -T4 vpn.target.ch</span> â†’ ports 443, 500, 4500
- <span class="technology">nmap -sV -O -p 443,500,4500 vpn.target.ch</span> â†’ Gateway VPN IPsec + serveur HTTPS
- <span class="technology">nmap --script vuln -p 443 vpn.target.ch</span> â†’ vÃ©rification vulnÃ©rabilitÃ©s connues
- <span class="technology">masscan -p1-65535 vpn.target.ch --rate 500</span> â†’ validation full ports
- <span class="technology">rustscan -a vpn.target.ch -- -sV</span> â†’ confirmation version Gateway VPN

---

## ğŸš€ Navigation

- ğŸ§© [[04_Enumeration]]
- ğŸš€ [[05_Exploitation]]
